var default_options={};function getId(e){return document.getElementById(e)}function save_options(){getId("default_time").value<0&&(getId("default_time").value=0),localStorage.default_time=getId("default_time").value,localStorage.random_time=getId("randomTime").checked,localStorage.autostart=getId("autostart").checked,localStorage.asurl=getId("asurl").value,localStorage.pdcheck=getId("pdcheck").checked,localStorage.pdurl=getId("pdurl").value,localStorage.timercheck=getId("timercheck").checked,getId("timer01").checked?localStorage.timermode="1":localStorage.timermode="2",localStorage.pmonitor=getId("pmonitor").checked,getId("pagemr01").checked?localStorage.pmpattern="A":localStorage.pmpattern="B",getId("pmsound01").checked?localStorage.sound="1":getId("pmsound02").checked?localStorage.sound="2":getId("pmsound03").checked?localStorage.sound="3":getId("pmsound04").checked&&(localStorage.sound="4"),localStorage.soundurl=getId("soundurl").value,localStorage.soundvolume=getId("soundvolume").value,getId("pm_sound_til_click").checked?localStorage.pm_sound_til="click":getId("pm_sound_til_sound").checked?localStorage.pm_sound_til="sound":getId("pm_sound_til_timeout").checked&&(localStorage.pm_sound_til="timeout"),localStorage.pm_sound_timeout=getId("pm_sound_timeout").value,localStorage.support=!document.getElementById("dontsupport").checked,show_save_animation()}function read_options(){localStorage.default_time&&(getId("default_time").value=localStorage.default_time),getId("randomTime").checked="true"==localStorage.random_time,getId("autostart").checked="true"==localStorage.autostart,getId("pdcheck").checked="true"==localStorage.pdcheck,getId("pmonitor").checked="true"==localStorage.pmonitor,getId("timercheck").checked="true"==localStorage.timercheck,getId("asurl").value=localStorage.asurl||"",localStorage.timermode?"1"==localStorage.timermode?getId("timer01").checked=!0:"2"==localStorage.timermode&&(getId("timer02").checked=!0):getId("timer01").checked=!0,localStorage.pmpattern&&"B"==localStorage.pmpattern?getId("pagemr02").checked=!0:getId("pagemr01").checked=!0,localStorage.sound&&"2"==localStorage.sound?getId("pmsound02").checked=!0:localStorage.sound&&"3"==localStorage.sound?getId("pmsound03").checked=!0:localStorage.sound&&"4"==localStorage.sound?getId("pmsound04").checked=!0:getId("pmsound01").checked=!0,getId("soundvolume").value=localStorage.soundvolume,getId("pdurl").value=localStorage.pdurl||"",getId("soundurl").value=localStorage.soundurl||"",localStorage.pm_sound_til||(localStorage.pm_sound_til="click"),getId("pm_sound_til_"+localStorage.pm_sound_til).checked=!0,getId("pm_sound_timeout").value=localStorage.pm_sound_timeout||5,document.getElementById("dontsupport").checked="false"==localStorage.support}function show_save_animation(){var e=getId("saved").style;e.zIndex=100,e.opacity=1,setTimeout(function(){e.opacity=0,setTimeout(function(){e.zIndex=-1},160)},800)}$(document).ready(function(){read_options(),$("#save").click(save_options),$("#cancel").click(function(){window.close()}),init()});var volume_change_timer,volume_fadeout_timer,sound=new Audio,is_sound_playing=!1;function play_sound(){if(clearInterval(volume_fadeout_timer),getId("pmsound02").checked)var e="./sound/sound1.mp3";else if(getId("pmsound03").checked)e="./sound/sound2.mp3";else if(getId("pmsound04").checked)e=getId("soundurl").value;e&&(sound.volume=getId("soundvolume").value,sound.src=e,sound.play())}function pause_sound(){sound.pause()}function pause_sound_with_fadeout(e){var o=e.volume;volume_fadeout_timer=setInterval(function(){o>0?(o-=.05,e.volume=Math.max(o,0)):(clearInterval(volume_fadeout_timer),e.pause())},16)}function init(){getId("test-play").onclick=play_sound;var e=document.getElementsByClassName("pmsound");[].forEach.call(e,function(e){e.onclick=play_sound}),getId("soundvolume").onchange=function(){sound.volume=this.value,sound.paused&&play_sound(),clearTimeout(volume_change_timer),volume_change_timer=setTimeout(function(){pause_sound_with_fadeout(sound)},2e3)},getId("incognito").onclick=function(){chrome.tabs.create({url:getId("incognito").href,active:!0})}}